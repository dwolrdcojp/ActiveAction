<div class="container-fluid">
<div class="row">
  <div class="col-sm-8">
    <h1>Action Items</h1></div>
  <div class="col-sm-4">
    <%= pie_chart Actionitem.group(:status).count, colors: ["#FF0000", "#00B431", "#FFF000"], id: "status-chart", width: "200px", height: "200px", legend: false, library: {title: {display: true, text: "Status Chart"}} %> 
    <%= link_to 'New Action Item', new_actionitem_path, class: "btn btn-primary", style: "float: right" %>
  </div>
</div>

<br>

<table class="table">
  <thead>
    <tr>
      <th scope="col">Id</th>
      <th scope="col">Created</th>
      <th scope="col">Focus</th>
      <th scope="col">Description</th>
      <th scope="col">Owner</th>
      <th scope="col">Due</th>
      <th scope="col">Resources</th>
      <th scope="col">Priority</th>
      <th scope="col">Status</th>
      <th scope="col">Updates</th>
      <th scope="col">Completion</th>
      <th scope="col">Updated</th>
      <th scope="col">Edit</th>
      <th scope="col">Delete</th>
    </tr>
  </thead>
  <tbody>
  <% @actionitems.each do |actionitem| %>
    <tr>
      <td><%= actionitem.id %></td>
      <td><%= actionitem.created_at.strftime("%-m/%-d") %></td>
      <td><%= actionitem.focus %></td>
      <td>
        <%= link_to actionitem.description, actionitem_path(actionitem) %>
        <%= actionitem.comments.any? ? fa_icon("comment-o") : "" %>
        <%= actionitem.comments.any? ? "#{actionitem.comments.count}" : "" %>
      </td>
      <td><%= actionitem.owner %></td>
      <td><%= "#{actionitem.due.strftime("%-m/%-d")}   " %><%= actionitem.due < Date.today() && actionitem.status != "Completed" ? fa_icon("flag", style: 'color:#ff4800;') : "" %></td>
      <td><%= actionitem.resources %></td>
      <td class="<% if actionitem.priority == 'High' %>
                  <%= 'btn btn-danger btn-block' %>
                 <% elsif actionitem.priority == 'Medium' %>
                  <%= 'btn btn-warning btn-block' %>
                 <% else %>
                  <%= 'btn btn-success btn-block' %>
                 <% end %>"><%= actionitem.priority %></td>
      <td><%= actionitem.status %></td>
      <td><%= actionitem.updates %></td>
      <td><%= actionitem.completion %></td>
      <td><%= actionitem.updated_at.strftime("%-m/%-d") %></td>
      <td><%= link_to fa_icon("pencil 2x"), edit_actionitem_path(actionitem), style: 'color:#00cc44;' %></td>
      <td><%= link_to fa_icon("trash 2x"), actionitem_path(actionitem), method: :delete, style: 'color:#ff4800;', data: { confirm: 'Are you sure?' } %></td>
    </tr>
  <% end %>
</tbody>
</table>
</div>